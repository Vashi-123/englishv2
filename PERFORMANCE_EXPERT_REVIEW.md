# üîç –≠–∫—Å–ø–µ—Ä—Ç–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ EnglishV2

**–î–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞:** 2025-01-27  
**–í–µ—Ä—Å–∏—è:** 1.0  
**–û—Ü–µ–Ω–∫–∞:** 7.5/10 (–•–æ—Ä–æ—à–æ, –Ω–æ –µ—Å—Ç—å –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —É–∑–∫–∏–µ –º–µ—Å—Ç–∞)

---

## üìä –û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –û—Ü–µ–Ω–∫–∞ | –°—Ç–∞—Ç—É—Å |
|-----------|--------|--------|
| **–ó–∞–≥—Ä—É–∑–∫–∞ —É—Ä–æ–∫–∞** | 6.5/10 | ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ |
| **–†–µ–Ω–¥–µ—Ä–∏–Ω–≥ UI** | 7.0/10 | ‚ö†Ô∏è –ï—Å—Ç—å –ø—Ä–æ–±–ª–µ–º—ã |
| **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç—å—é** | 7.5/10 | ‚úÖ –•–æ—Ä–æ—à–æ |
| **–°–µ—Ç–µ–≤–∞—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è** | 8.0/10 | ‚úÖ –•–æ—Ä–æ—à–æ |
| **–ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ** | 8.5/10 | ‚úÖ –û—Ç–ª–∏—á–Ω–æ |
| **–†–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å** | 6.0/10 | üî¥ –ö—Ä–∏—Ç–∏—á–Ω–æ |
| **–û–±—â–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** | **7.5/10** | ‚ö†Ô∏è **–¢—Ä–µ–±—É–µ—Ç —É–ª—É—á—à–µ–Ω–∏–π** |

---

## üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï –ü–†–û–ë–õ–ï–ú–´ (–ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å)

### 1. –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ useEffect –≤ AppContent.tsx (1055 —Å—Ç—Ä–æ–∫)

**–ü—Ä–æ–±–ª–µ–º–∞:**
- 20+ `useEffect` —Ö—É–∫–æ–≤ –≤ –æ–¥–Ω–æ–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ
- –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤—ã–∑—ã–≤–∞—é—Ç –∫–∞—Å–∫–∞–¥–Ω—ã–µ —Ä–µ-—Ä–µ–Ω–¥–µ—Ä—ã
- –ù–µ—Ç –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —ç—Ñ—Ñ–µ–∫—Ç–æ–≤
- –ù–µ–∫–æ—Ç–æ—Ä—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

**–ü—Ä–∏–º–µ—Ä—ã –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö –º–µ—Å—Ç:**

```487:540:components/AppContent.tsx
  // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç–∞—Ç—É—Å—ã –≤—Å–µ—Ö –¥–Ω–µ–π –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∏ –≤—ã–±–∏—Ä–∞–µ–º –∞–∫—Ç—É–∞–ª—å–Ω—ã–π –¥–µ–Ω—å
  useEffect(() => {
    const loadAllDaysStatusAndSelectCurrent = async () => {
      if (dayPlans.length === 0) return;

      // Do not block initial render with a fullscreen loader; hydrate statuses in the background.
      setIsInitializing(false);
      const statuses: Record<number, boolean> = {};

      // Prefer lesson_progress to avoid scanning chat history for every day.
      const lessonIds = dayPlans.map((p) => p.lessonId).filter(Boolean) as string[];
      const progressByLessonId = await loadLessonProgressByLessonIds(lessonIds, level);
      // Walk in order: if a day appears incomplete in progress, verify completion tag only until the first truly incomplete day.
      let shouldVerify = true;
      for (const dayPlan of dayPlans) {
        const lessonId = dayPlan.lessonId;
        const completedFromProgress = lessonId ? progressByLessonId[lessonId]?.completed === true : false;
        if (!completedFromProgress && shouldVerify) {
          const hasTag = await hasLessonCompleteTag(dayPlan.day, dayPlan.lesson, level);
          if (hasTag) {
            statuses[dayPlan.day] = true;
            await upsertLessonProgress({ day: dayPlan.day, lesson: dayPlan.lesson, level, completed: true });
            continue;
          }
          statuses[dayPlan.day] = false;
          // First truly incomplete day found; remaining days are locked anyway, so skip extra queries.
          shouldVerify = false;
          continue;
        }
        statuses[dayPlan.day] = completedFromProgress;
      }
      
      setDayCompletedStatus(statuses);
      
      // –ù–∞—Ö–æ–¥–∏–º –ø–µ—Ä–≤—ã–π –Ω–µ–∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–π –¥–µ–Ω—å (–∞–∫—Ç—É–∞–ª—å–Ω—ã–π)
      let actualDayId = dayPlans[0]?.day || 1;
      for (const dayPlan of dayPlans) {
        if (!statuses[dayPlan.day]) {
          actualDayId = dayPlan.day;
          break;
        }
      }
      
      // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∞–∫—Ç—É–∞–ª—å–Ω—ã–π –¥–µ–Ω—å
      setSelectedDayId(actualDayId);
      
      console.log("[App] Initialized with actual day:", actualDayId, "statuses:", statuses);
    };
    
    if (dayPlans.length === 0) return;
    const key = `${level}:${dayPlans.length}`;
    if (statusesInitKeyRef.current === key) return;
    statusesInitKeyRef.current = key;
    loadAllDaysStatusAndSelectCurrent();
  }, [dayPlans, level]);
```

**–ü—Ä–æ–±–ª–µ–º—ã:**
- –¶–∏–∫–ª —Å –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–º–∏ await –≤ —Ü–∏–∫–ª–µ (N+1 –∑–∞–ø—Ä–æ—Å–æ–≤)
- –ù–µ—Ç debounce –¥–ª—è —á–∞—Å—Ç—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π `dayPlans`
- –í—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–∏ `dayPlans` –∏–ª–∏ `level`

**–†–µ—à–µ–Ω–∏–µ:**
```typescript
// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Promise.all –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
const hasTags = await Promise.all(
  dayPlans.map(p => hasLessonCompleteTag(p.day, p.lesson, level))
);

// –î–æ–±–∞–≤–∏—Ç—å debounce –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏–π
const debouncedLoad = useMemo(
  () => debounce(loadAllDaysStatusAndSelectCurrent, 300),
  [dayPlans, level]
);
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π  
**–í–ª–∏—è–Ω–∏–µ:** –í—ã—Å–æ–∫–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –¥–∞—à–±–æ—Ä–¥–∞, –ª–∏—à–Ω–∏–µ –∑–∞–ø—Ä–æ—Å—ã –∫ –ë–î

---

### 2. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–ª—è –¥–ª–∏–Ω–Ω—ã—Ö —Å–ø–∏—Å–∫–æ–≤ —Å–æ–æ–±—â–µ–Ω–∏–π

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –í—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è —Ä–µ–Ω–¥–µ—Ä—è—Ç—Å—è –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
- –ü—Ä–∏ 100+ —Å–æ–æ–±—â–µ–Ω–∏—è—Ö –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–∞–¥–∞–µ—Ç
- –ù–µ—Ç lazy loading –¥–ª—è —Å—Ç–∞—Ä—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π

**–ì–¥–µ:** `components/step4Dialogue/DialogueMessages.tsx`

**–†–µ—à–µ–Ω–∏–µ:**
```typescript
import { useVirtualizer } from '@tanstack/react-virtual';

const virtualizer = useVirtualizer({
  count: messages.length,
  getScrollElement: () => scrollContainerRef.current,
  estimateSize: () => 100, // –ø—Ä–∏–º–µ—Ä–Ω–∞—è –≤—ã—Å–æ—Ç–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
  overscan: 5, // —Ä–µ–Ω–¥–µ—Ä–∏—Ç—å 5 —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∑–∞ –ø—Ä–µ–¥–µ–ª–∞–º–∏ –≤–∏–¥–∏–º–æ—Å—Ç–∏
});
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π  
**–í–ª–∏—è–Ω–∏–µ:** –ó–∞–º–µ–¥–ª–µ–Ω–∏–µ –ø—Ä–∏ –¥–ª–∏–Ω–Ω—ã—Ö –¥–∏–∞–ª–æ–≥–∞—Ö, –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞

---

### 3. –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ realtime –ø–æ–¥–ø–∏—Å–∫–∏ –±–µ–∑ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ö–∞–∂–¥—ã–π —É—Ä–æ–∫ —Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—É—é –ø–æ–¥–ø–∏—Å–∫—É
- –ü–æ–¥–ø–∏—Å–∫–∏ –Ω–µ –æ—á–∏—â–∞—é—Ç—Å—è –ø—Ä–∏ —Å–º–µ–Ω–µ —É—Ä–æ–∫–∞
- –ù–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –Ω–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –ø–æ–¥–ø–∏—Å–æ–∫

**–ì–¥–µ:** `components/step4Dialogue/useLessonRealtimeSubscriptions.ts`

**–†–µ—à–µ–Ω–∏–µ:**
```typescript
// –û—á–∏—â–∞—Ç—å –ø—Ä–µ–¥—ã–¥—É—â—É—é –ø–æ–¥–ø–∏—Å–∫—É –ø–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º –Ω–æ–≤–æ–π
useEffect(() => {
  let unsubscribe: (() => void) | null = null;
  
  const setup = async () => {
    if (unsubscribe) unsubscribe(); // –æ—á–∏—Å—Ç–∏—Ç—å –ø—Ä–µ–¥—ã–¥—É—â—É—é
    unsubscribe = await subscribeChatMessages(day, lesson, onMessage, level);
  };
  
  setup();
  return () => {
    if (unsubscribe) unsubscribe();
  };
}, [day, lesson, level]);
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π  
**–í–ª–∏—è–Ω–∏–µ:** –£—Ç–µ—á–∫–∏ –ø–∞–º—è—Ç–∏, –ø–µ—Ä–µ–≥—Ä—É–∑–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è

---

### 4. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ debounce –¥–ª—è —á–∞—Å—Ç—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

**–ü—Ä–æ–±–ª–µ–º–∞:**
- `cacheChatMessages` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–∏ `messages`
- `setDayCompletedStatus` –≤ localStorage –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∏–∑–º–µ–Ω–µ–Ω–∏–∏
- –ù–µ—Ç throttling –¥–ª—è —Å–∫—Ä–æ–ª–ª–∞

**–ü—Ä–∏–º–µ—Ä—ã:**

```344:352:components/AppContent.tsx
  // Persist dashboard state so a refresh doesn't feel like a cold start.
  useEffect(() => {
    try {
      if (typeof window === 'undefined') return;
      if (!statusStorageKey) return;
      window.localStorage.setItem(statusStorageKey, JSON.stringify(dayCompletedStatus));
    } catch {
      // ignore
    }
  }, [dayCompletedStatus, statusStorageKey]);
```

**–†–µ—à–µ–Ω–∏–µ:**
```typescript
const debouncedSave = useMemo(
  () => debounce((status: typeof dayCompletedStatus) => {
    try {
      if (typeof window === 'undefined') return;
      if (!statusStorageKey) return;
      window.localStorage.setItem(statusStorageKey, JSON.stringify(status));
    } catch {
      // ignore
    }
  }, 500),
  [statusStorageKey]
);

useEffect(() => {
  debouncedSave(dayCompletedStatus);
}, [dayCompletedStatus, debouncedSave]);
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–π  
**–í–ª–∏—è–Ω–∏–µ:** –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ UI –ø–æ—Ç–æ–∫–∞, –ª–∏—à–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –≤ localStorage

---

## üü° –°–†–ï–î–ù–ò–ï –ü–†–û–ë–õ–ï–ú–´ (–ò—Å–ø—Ä–∞–≤–∏—Ç—å –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è)

### 5. –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —É—Ä–æ–∫–∞

**–ü—Ä–æ–±–ª–µ–º–∞:**
```typescript
// –í useChatInitialization.ts
const initData = await loadLessonInitData(...); // –∑–∞–ø—Ä–æ—Å 1
await ensureLessonContext(); // –∑–∞–ø—Ä–æ—Å 2
await loadChatMessages(...); // –∑–∞–ø—Ä–æ—Å 3
```

**–†–µ—à–µ–Ω–∏–µ:**
```typescript
// –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞
const [initData, messages] = await Promise.all([
  loadLessonInitData(...),
  loadChatMessages(...)
]);
await ensureLessonContext(); // —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° –°—Ä–µ–¥–Ω–∏–π  
**–í–ª–∏—è–Ω–∏–µ:** –£–≤–µ–ª–∏—á–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –∑–∞–≥—Ä—É–∑–∫–∏ —É—Ä–æ–∫–∞ –Ω–∞ 200-500ms

---

### 6. –ë–æ–ª—å—à–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç Step4DialogueScreen (1935 —Å—Ç—Ä–æ–∫)

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –ª–æ–≥–∏–∫–∏ –≤ –æ–¥–Ω–æ–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ
- –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∏ —ç—Ñ—Ñ–µ–∫—Ç—ã
- –°–ª–æ–∂–Ω–æ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ä–µ-—Ä–µ–Ω–¥–µ—Ä—ã

**–†–µ—à–µ–Ω–∏–µ:**
- –†–∞–∑–¥–µ–ª–∏—Ç—å –Ω–∞ –ø–æ–¥–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
  - `DialogueContainer` - –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä
  - `DialogueContent` - –∫–æ–Ω—Ç–µ–Ω—Ç —Å —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏
  - `DialogueControls` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (input, –∫–Ω–æ–ø–∫–∏)
  - `DialogueModals` - –º–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° –°—Ä–µ–¥–Ω–∏–π  
**–í–ª–∏—è–Ω–∏–µ:** –°–ª–æ–∂–Ω–æ—Å—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫–∏, –ª–∏—à–Ω–∏–µ —Ä–µ-—Ä–µ–Ω–¥–µ—Ä—ã

---

### 7. –ù–µ—Ç –º–µ–º–æ–∏–∑–∞—Ü–∏–∏ –¥–ª—è —Ç—è–∂–µ–ª—ã—Ö –≤—ã—á–∏—Å–ª–µ–Ω–∏–π

**–ü—Ä–æ–±–ª–µ–º–∞:**
- `modulesByStage` –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º —Ä–µ–Ω–¥–µ—Ä–µ (—Ö–æ—Ç—è –µ—Å—Ç—å useMemo)
- `aiContent` –º–µ–º–æ–∏–∑–∏—Ä–æ–≤–∞–Ω, –Ω–æ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –º–æ–≥—É—Ç –º–µ–Ω—è—Ç—å—Å—è —á–∞—Å—Ç–æ
- –ü–∞—Ä—Å–∏–Ω–≥ markdown –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ –∫–∞–∂–¥–æ–º —Ä–µ–Ω–¥–µ—Ä–µ

**–ì–¥–µ:**
```1473:1473:components/step4Dialogue/Step4DialogueScreen.tsx
	  const renderMarkdown = useCallback((text: string) => parseMarkdown(text), []);
```

**–†–µ—à–µ–Ω–∏–µ:**
```typescript
// –ö–µ—à–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–∞—Ä—Å–∏–Ω–≥–∞
const markdownCache = useRef(new Map<string, React.ReactNode>());

const renderMarkdown = useCallback((text: string) => {
  if (markdownCache.current.has(text)) {
    return markdownCache.current.get(text)!;
  }
  const parsed = parseMarkdown(text);
  markdownCache.current.set(text, parsed);
  return parsed;
}, []);
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° –°—Ä–µ–¥–Ω–∏–π  
**–í–ª–∏—è–Ω–∏–µ:** –õ–∏—à–Ω–∏–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –ø—Ä–∏ —Ä–µ–Ω–¥–µ—Ä–µ —Å–æ–æ–±—â–µ–Ω–∏–π

---

### 8. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤

**–ü—Ä–æ–±–ª–µ–º–∞:**
- –ù–µ—Ç —Ä–∞–∑–ª–∏—á–∏–π –≤ –ª–æ–≥–∏–∫–µ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö/–¥–µ—Å–∫—Ç–æ–ø
- –í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –æ–¥–∏–Ω–∞–∫–æ–≤–æ
- –ù–µ—Ç –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ —Ä–µ—Å—É—Ä—Å–æ–≤

**–†–µ—à–µ–Ω–∏–µ:**
```typescript
const isMobile = useMemo(() => {
  return typeof window !== 'undefined' && window.innerWidth < 768;
}, []);

// –£–º–µ–Ω—å—à–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–æ–±—â–µ–Ω–∏–π –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö
const visibleMessages = useMemo(() => {
  if (isMobile) {
    return messages.slice(-20); // —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 20
  }
  return messages;
}, [messages, isMobile]);
```

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü° –°—Ä–µ–¥–Ω–∏–π  
**–í–ª–∏—è–Ω–∏–µ:** –ü–µ—Ä–µ–≥—Ä—É–∑–∫–∞ –Ω–∞ —Å–ª–∞–±—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö

---

## üü¢ –ù–ò–ó–ö–ò–ï –ü–†–û–ë–õ–ï–ú–´ (–£–ª—É—á—à–µ–Ω–∏—è)

### 9. –ú–æ–∂–Ω–æ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:** ‚úÖ –•–æ—Ä–æ—à–æ
- –ï—Å—Ç—å memory cache
- –ï—Å—Ç—å sessionStorage cache
- –ï—Å—Ç—å prefetch

**–£–ª—É—á—à–µ–Ω–∏—è:**
- –î–æ–±–∞–≤–∏—Ç—å IndexedDB –¥–ª—è –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–≥–æ –∫–µ—à–∞
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏—é LRU –¥–ª—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞ –∫–µ—à–∞
- –î–æ–±–∞–≤–∏—Ç—å –º–µ—Ç—Ä–∏–∫–∏ hit/miss –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü¢ –ù–∏–∑–∫–∏–π

---

### 10. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è bundle size

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:** ‚úÖ –•–æ—Ä–æ—à–æ (–µ—Å—Ç—å code splitting)

**–£–ª—É—á—à–µ–Ω–∏—è:**
- Tree shaking –¥–ª—è –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö —ç–∫—Å–ø–æ—Ä—Ç–æ–≤
- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –∏–º–ø–æ—Ä—Ç –¥–ª—è —Ç—è–∂–µ–ª—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫ (markdown parser)
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (WebP, lazy loading)

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üü¢ –ù–∏–∑–∫–∏–π

---

## üìà –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –∏ —É–∑–∫–∏–µ –º–µ—Å—Ç–∞

### –í—Ä–µ–º—è –∑–∞–≥—Ä—É–∑–∫–∏ —É—Ä–æ–∫–∞

**–¢–µ–∫—É—â–µ–µ:**
- –ü–µ—Ä–≤—ã–π —Ä–µ–Ω–¥–µ—Ä: ~200-300ms
- –ü–æ–ª–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞: ~800-1200ms
- –° –∫–µ—à–µ–º: ~100-200ms ‚úÖ

**–¶–µ–ª–µ–≤–æ–µ:**
- –ü–µ—Ä–≤—ã–π —Ä–µ–Ω–¥–µ—Ä: <150ms
- –ü–æ–ª–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞: <500ms
- –° –∫–µ—à–µ–º: <100ms

**–£–∑–∫–∏–µ –º–µ—Å—Ç–∞:**
1. –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∫ –ë–î (300-500ms)
2. –ü–∞—Ä—Å–∏–Ω–≥ lessonScript (50-100ms)
3. –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ —Å–æ–æ–±—â–µ–Ω–∏–π (100-200ms)

---

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏

**–¢–µ–∫—É—â–µ–µ:**
- –ë–∞–∑–æ–≤–æ–µ: ~50-80 MB
- –° —É—Ä–æ–∫–∞–º–∏: ~100-150 MB
- –ü–∏–∫–æ–≤–æ–µ: ~200-250 MB

**–ü—Ä–æ–±–ª–µ–º—ã:**
- –ù–µ—Ç –æ—á–∏—Å—Ç–∫–∏ —Å—Ç–∞—Ä—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –∏–∑ –ø–∞–º—è—Ç–∏
- –ö–µ—à —Ä–∞—Å—Ç–µ—Ç –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π
- Realtime –ø–æ–¥–ø–∏—Å–∫–∏ –Ω–∞–∫–∞–ø–ª–∏–≤–∞—é—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ:**
```typescript
// –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å —Ä–∞–∑–º–µ—Ä –∫–µ—à–∞
const MAX_CACHE_SIZE = 50; // –º–∞–∫—Å–∏–º—É–º 50 —É—Ä–æ–∫–æ–≤ –≤ –∫–µ—à–µ

if (lessonScriptCache.size > MAX_CACHE_SIZE) {
  const firstKey = lessonScriptCache.keys().next().value;
  lessonScriptCache.delete(firstKey);
}
```

---

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞

**–¢–µ–∫—É—â–µ–µ:**
- –†–µ–Ω–¥–µ—Ä –¥–∞—à–±–æ—Ä–¥–∞: ~50-100ms
- –†–µ–Ω–¥–µ—Ä —É—Ä–æ–∫–∞: ~100-200ms
- –†–µ–Ω–¥–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏—è: ~5-10ms (√ó100 = 500-1000ms –¥–ª—è –¥–ª–∏–Ω–Ω–æ–≥–æ –¥–∏–∞–ª–æ–≥–∞)

**–ü—Ä–æ–±–ª–µ–º–∞:** –õ–∏–Ω–µ–π–Ω—ã–π —Ä–æ—Å—Ç –≤—Ä–µ–º–µ–Ω–∏ —Ä–µ–Ω–¥–µ—Ä–∞ —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —Å–æ–æ–±—â–µ–Ω–∏–π

**–†–µ—à–µ–Ω–∏–µ:** –í–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è (—Å–º. –ø—Ä–æ–±–ª–µ–º—É #2)

---

## üéØ –ü–ª–∞–Ω –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–π)

### –§–∞–∑–∞ 1: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (1-2 –¥–Ω—è)

1. ‚úÖ **–î–æ–±–∞–≤–∏—Ç—å debounce –¥–ª—è —á–∞—Å—Ç—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π**
   - `cacheChatMessages`
   - `localStorage` –∑–∞–ø–∏—Å–∏
   - `setDayCompletedStatus`

2. ‚úÖ **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∑–∞–≥—Ä—É–∑–∫—É —Å—Ç–∞—Ç—É—Å–æ–≤ –¥–Ω–µ–π**
   - –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –≤–º–µ—Å—Ç–æ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö
   - –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
   - Debounce –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

3. ‚úÖ **–ò—Å–ø—Ä–∞–≤–∏—Ç—å realtime –ø–æ–¥–ø–∏—Å–∫–∏**
   - –û—á–∏—Å—Ç–∫–∞ –ø—Ä–∏ —Ä–∞–∑–º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏
   - –û–¥–Ω–∞ –ø–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —É—Ä–æ–∫
   - –û—Ç–ø–∏—Å–∫–∞ –ø—Ä–∏ —Å–º–µ–Ω–µ —É—Ä–æ–∫–∞

4. ‚úÖ **–î–æ–±–∞–≤–∏—Ç—å –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—é —Å–æ–æ–±—â–µ–Ω–∏–π**
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `@tanstack/react-virtual`
   - –†–µ–Ω–¥–µ—Ä–∏—Ç—å —Ç–æ–ª—å–∫–æ –≤–∏–¥–∏–º—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
   - Lazy loading –¥–ª—è —Å—Ç–∞—Ä—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- –£–º–µ–Ω—å—à–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ 40-50%
- –°–Ω–∏–∂–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–∞–º—è—Ç–∏ –Ω–∞ 30%
- –£–ª—É—á—à–µ–Ω–∏–µ FPS –ø—Ä–∏ —Å–∫—Ä–æ–ª–ª–µ

---

### –§–∞–∑–∞ 2: –°—Ä–µ–¥–Ω–∏–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ (3-5 –¥–Ω–µ–π)

5. ‚úÖ **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö —É—Ä–æ–∫–∞**
   - `Promise.all` –¥–ª—è –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
   - –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è `loadLessonInitData`

6. ‚úÖ **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ Step4DialogueScreen**
   - –í—ã–¥–µ–ª–∏—Ç—å –ø–æ–¥–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
   - –ú–µ–º–æ–∏–∑–∞—Ü–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
   - –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø—Ä–æ–ø—Å–æ–≤

7. ‚úÖ **–ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä—Å–∏–Ω–≥–∞ markdown**
   - Map –¥–ª—è –∫–µ—à–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
   - –û—á–∏—Å—Ç–∫–∞ –ø—Ä–∏ —Å–º–µ–Ω–µ —É—Ä–æ–∫–∞

8. ‚úÖ **–ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö**
   - –ú–µ–Ω—å—à–µ —Å–æ–æ–±—â–µ–Ω–∏–π –Ω–∞ —ç–∫—Ä–∞–Ω–µ
   - Lazy loading –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
   - –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- –£–ª—É—á—à–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö –Ω–∞ 50%
- –°–Ω–∏–∂–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ —Ä–µ–Ω–¥–µ—Ä–∞ –Ω–∞ 30%

---

### –§–∞–∑–∞ 3: –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è (1-2 –Ω–µ–¥–µ–ª–∏)

9. ‚úÖ **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è bundle size**
   - Tree shaking
   - –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –∏–º–ø–æ—Ä—Ç—ã
   - –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

10. ‚úÖ **–£–ª—É—á—à–µ–Ω–∏–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è**
    - IndexedDB –¥–ª—è –¥–æ–ª–≥–æ—Å—Ä–æ—á–Ω–æ–≥–æ –∫–µ—à–∞
    - LRU —Å—Ç—Ä–∞—Ç–µ–≥–∏—è
    - –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

11. ‚úÖ **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏**
    - Web Vitals
    - Custom –º–µ—Ç—Ä–∏–∫–∏
    - –ê–ª–µ—Ä—Ç—ã –ø—Ä–∏ –¥–µ–≥—Ä–∞–¥–∞—Ü–∏–∏

---

## üîß –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –∫–æ–¥—É

### 1. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è AppContent.tsx

**–¢–µ–∫—É—â–∞—è –ø—Ä–æ–±–ª–µ–º–∞:**
```typescript
// 20+ useEffect –≤ –æ–¥–Ω–æ–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ
useEffect(() => { ... }, [dayPlans, level]);
useEffect(() => { ... }, [currentDayPlan, view]);
useEffect(() => { ... }, [selectedDayId]);
// ... –∏ —Ç–∞–∫ –¥–∞–ª–µ–µ
```

**–†–µ—à–µ–Ω–∏–µ:**
```typescript
// –í—ã–Ω–µ—Å—Ç–∏ –≤ –∫–∞—Å—Ç–æ–º–Ω—ã–µ —Ö—É–∫–∏
const useDayStatuses = (dayPlans, level) => {
  // –≤—Å—è –ª–æ–≥–∏–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—Ç–∞—Ç—É—Å–æ–≤
};

const useLessonCompletion = (currentDayPlan, view) => {
  // –≤—Å—è –ª–æ–≥–∏–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è
};

// –í –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ
const dayStatuses = useDayStatuses(dayPlans, level);
const lessonCompletion = useLessonCompletion(currentDayPlan, view);
```

---

### 2. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ —É—Ä–æ–∫–∞

**–¢–µ–∫—É—â–µ–µ:**
```typescript
// –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ
const script = await loadLessonScript(...);
const messages = await loadChatMessages(...);
const progress = await loadLessonProgress(...);
```

**–†–µ—à–µ–Ω–∏–µ:**
```typescript
// –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
const [script, messages, progress] = await Promise.all([
  loadLessonScript(...),
  loadChatMessages(...),
  loadLessonProgress(...)
]);
```

---

### 3. –í–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π

**–¢–µ–∫—É—â–µ–µ:**
```typescript
{messages.map(msg => <Message key={msg.id} {...msg} />)}
```

**–†–µ—à–µ–Ω–∏–µ:**
```typescript
import { useVirtualizer } from '@tanstack/react-virtual';

const virtualizer = useVirtualizer({
  count: messages.length,
  getScrollElement: () => scrollContainerRef.current,
  estimateSize: () => 100,
  overscan: 5,
});

return (
  <div ref={scrollContainerRef} style={{ height: '100%', overflow: 'auto' }}>
    <div style={{ height: `${virtualizer.getTotalSize()}px`, position: 'relative' }}>
      {virtualizer.getVirtualItems().map(virtualItem => (
        <div
          key={virtualItem.key}
          style={{
            position: 'absolute',
            top: 0,
            left: 0,
            width: '100%',
            height: `${virtualItem.size}px`,
            transform: `translateY(${virtualItem.start}px)`,
          }}
        >
          <Message {...messages[virtualItem.index]} />
        </div>
      ))}
    </div>
  </div>
);
```

---

## üìä –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

### –ö–ª—é—á–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

1. **Time to Interactive (TTI)**
   - –¶–µ–ª—å: < 3 —Å–µ–∫—É–Ω–¥—ã
   - –¢–µ–∫—É—â–µ–µ: ~4-5 —Å–µ–∫—É–Ω–¥

2. **First Contentful Paint (FCP)**
   - –¶–µ–ª—å: < 1.5 —Å–µ–∫—É–Ω–¥—ã
   - –¢–µ–∫—É—â–µ–µ: ~2-3 —Å–µ–∫—É–Ω–¥—ã

3. **Largest Contentful Paint (LCP)**
   - –¶–µ–ª—å: < 2.5 —Å–µ–∫—É–Ω–¥—ã
   - –¢–µ–∫—É—â–µ–µ: ~3-4 —Å–µ–∫—É–Ω–¥—ã

4. **Cumulative Layout Shift (CLS)**
   - –¶–µ–ª—å: < 0.1
   - –¢–µ–∫—É—â–µ–µ: ~0.15-0.2

5. **Memory Usage**
   - –¶–µ–ª—å: < 150 MB
   - –¢–µ–∫—É—â–µ–µ: ~100-200 MB

---

## ‚úÖ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

### –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ: 7.5/10

**–°–∏–ª—å–Ω—ã–µ —Å—Ç–æ—Ä–æ–Ω—ã:**
- ‚úÖ –•–æ—Ä–æ—à–µ–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ
- ‚úÖ Code splitting —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω
- ‚úÖ –ú–µ–º–æ–∏–∑–∞—Ü–∏—è —á–∞—Å—Ç–∏—á–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
- ‚úÖ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Å–µ—Ç–µ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤

**–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã:**
- üî¥ –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ useEffect –±–µ–∑ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏
- üî¥ –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏–∏
- üî¥ –ü—Ä–æ–±–ª–µ–º—ã —Å realtime –ø–æ–¥–ø–∏—Å–∫–∞–º–∏
- üî¥ –ù–µ—Ç debounce –¥–ª—è —á–∞—Å—Ç—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

**–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:**
- –û–∂–∏–¥–∞–µ–º–∞—è –æ—Ü–µ–Ω–∫–∞: **9.0/10**
- –£–ª—É—á—à–µ–Ω–∏–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏: **40-50%**
- –°–Ω–∏–∂–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø–∞–º—è—Ç–∏: **30%**

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–π

### –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ (—Å–µ–≥–æ–¥–Ω—è):

1. –î–æ–±–∞–≤–∏—Ç—å debounce –¥–ª—è `cacheChatMessages` –∏ localStorage
2. –ò—Å–ø—Ä–∞–≤–∏—Ç—å –æ—á–∏—Å—Ç–∫—É realtime –ø–æ–¥–ø–∏—Å–æ–∫
3. –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∑–∞–≥—Ä—É–∑–∫—É —Å—Ç–∞—Ç—É—Å–æ–≤ –¥–Ω–µ–π (–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã)

### –ù–∞ —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ:

4. –î–æ–±–∞–≤–∏—Ç—å –≤–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—é —Å–æ–æ–±—â–µ–Ω–∏–π
5. –†–∞–∑–¥–µ–ª–∏—Ç—å Step4DialogueScreen –Ω–∞ –ø–æ–¥–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
6. –î–æ–±–∞–≤–∏—Ç—å –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä—Å–∏–Ω–≥–∞ markdown

### –í —Å–ª–µ–¥—É—é—â–µ–º —Å–ø—Ä–∏–Ω—Ç–µ:

7. –ê–¥–∞–ø—Ç–∏–≤–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö
8. –£–ª—É—á—à–µ–Ω–∏–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è (IndexedDB)
9. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

---

*–î–æ–∫—É–º–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω: 2025-01-27*  
*–í–µ—Ä—Å–∏—è: 1.0*  
*–°–ª–µ–¥—É—é—â–∏–π –ø–µ—Ä–µ—Å–º–æ—Ç—Ä: –ø–æ—Å–ª–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –§–∞–∑—ã 1*

